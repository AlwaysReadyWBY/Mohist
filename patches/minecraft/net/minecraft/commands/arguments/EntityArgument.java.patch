--- a/net/minecraft/commands/arguments/EntityArgument.java
+++ b/net/minecraft/commands/arguments/EntityArgument.java
@@ -118,12 +_,31 @@
         }
     }
 
-    @Override
+   	public EntitySelector parse(StringReader p_345548_, boolean p_345553_, boolean overridePermissions) throws CommandSyntaxException {
+        EntitySelectorParser entityselectorparser = new EntitySelectorParser(p_345548_, p_345553_);
+        EntitySelector entityselector = entityselectorparser.parse(overridePermissions);
+        if (entityselector.getMaxResults() > 1 && this.single) {
+            if (this.playersOnly) {
+                p_345548_.setCursor(0);
+                throw ERROR_NOT_SINGLE_PLAYER.createWithContext(p_345548_);
+            } else {
+                p_345548_.setCursor(0);
+                throw ERROR_NOT_SINGLE_ENTITY.createWithContext(p_345548_);
+            }
+        } else if (entityselector.includesEntities() && this.playersOnly && !entityselector.isSelfSelector()) {
+            p_345548_.setCursor(0);
+            throw ERROR_ONLY_PLAYERS_ALLOWED.createWithContext(p_345548_);
+        } else {
+            return entityselector;
+        }
+    }
+
+	@Override
     public <S> CompletableFuture<Suggestions> listSuggestions(CommandContext<S> p_91482_, SuggestionsBuilder p_91483_) {
         if (p_91482_.getSource() instanceof SharedSuggestionProvider sharedsuggestionprovider) {
             StringReader stringreader = new StringReader(p_91483_.getInput());
             stringreader.setCursor(p_91483_.getStart());
-            EntitySelectorParser entityselectorparser = new EntitySelectorParser(stringreader, EntitySelectorParser.allowSelectors(sharedsuggestionprovider));
+            EntitySelectorParser entityselectorparser = new EntitySelectorParser(stringreader, net.minecraftforge.common.ForgeHooks.canUseEntitySelectors(sharedsuggestionprovider));
 
             try {
                 entityselectorparser.parse();
