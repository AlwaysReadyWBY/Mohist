--- a/net/minecraft/world/inventory/InventoryMenu.java
+++ b/net/minecraft/world/inventory/InventoryMenu.java
@@ -12,6 +_,8 @@
 import net.minecraft.world.item.crafting.Recipe;
 import net.minecraft.world.item.crafting.RecipeHolder;
 import net.minecraft.world.item.enchantment.EnchantmentHelper;
+import org.bukkit.craftbukkit.inventory.CraftInventoryCrafting;
+import org.bukkit.craftbukkit.inventory.CraftInventoryView;
 
 public class InventoryMenu extends RecipeBookMenu<CraftingContainer> {
     public static final int CONTAINER_ID = 0;
@@ -39,11 +_,28 @@
     private final ResultContainer resultSlots = new ResultContainer();
     public final boolean active;
     private final Player owner;
+   	// CraftBukkit start
+   	private CraftInventoryView bukkitEntity = null;
+   	private Inventory player;
+  	@Override
+   	public CraftInventoryView getBukkitView() {
+      	if (bukkitEntity != null) {
+         	return bukkitEntity;
+      	}
+
+      	CraftInventoryCrafting inventory = new CraftInventoryCrafting(this.craftSlots, this.resultSlots);
+      	bukkitEntity = new CraftInventoryView(this.player.player.getBukkitEntity(), inventory, this);
+      	return bukkitEntity;
+   	}
+   	// CraftBukkit end
 
     public InventoryMenu(Inventory p_39706_, boolean p_39707_, final Player p_39708_) {
         super(null, 0);
         this.active = p_39707_;
         this.owner = p_39708_;
+      	((TransientCraftingContainer)this.craftSlots).resultInventory = this.resultSlots; // CraftBukkit - let InventoryCrafting know about its result slot
+      	((TransientCraftingContainer)this.craftSlots).setOwner(p_39706_.player);
+      	this.player = p_39706_; // CraftBukkit - save player
         this.addSlot(new ResultSlot(p_39706_.player, this.craftSlots, this.resultSlots, 0, 154, 28));
 
         for (int i = 0; i < 2; i++) {
@@ -68,7 +_,7 @@
 
                 @Override
                 public boolean mayPlace(ItemStack p_39746_) {
-                    return equipmentslot == Mob.getEquipmentSlotForItem(p_39746_);
+                    return p_39746_.canEquip(equipmentslot, owner);
                 }
 
                 @Override
