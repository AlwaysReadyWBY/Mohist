--- a/net/minecraft/world/level/BaseCommandBlock.java
+++ b/net/minecraft/world/level/BaseCommandBlock.java
@@ -29,6 +_,10 @@
    private Component lastOutput;
    private String command = "";
    private Component name = DEFAULT_NAME;
+   // CraftBukkit start
+   @Override
+   public abstract org.bukkit.command.CommandSender getBukkitSender(CommandSourceStack wrapper);
+   // CraftBukkit end
 
    public int getSuccessCount() {
       return this.successCount;
@@ -113,13 +_,13 @@
             if (minecraftserver.isCommandBlockEnabled() && !StringUtil.isNullOrEmpty(this.command)) {
                try {
                   this.lastOutput = null;
-                  CommandSourceStack commandsourcestack = this.createCommandSourceStack().withCallback((p_45418_, p_45419_) -> {
+                  CommandSourceStack commandsourcestack = this.createCommandSourceStack().withCallback((p_45417_, p_45418_, p_45419_) -> {
                      if (p_45418_) {
                         ++this.successCount;
                      }
 
                   });
-                  minecraftserver.getCommands().performPrefixedCommand(commandsourcestack, this.command);
+                  minecraftserver.getCommands().dispatchServerCommand(commandsourcestack, this.command);
                } catch (Throwable throwable) {
                   CrashReport crashreport = CrashReport.forThrowable(throwable, "Executing command block");
                   CrashReportCategory crashreportcategory = crashreport.addCategory("Command to be executed");
